#include<stdio.h>
#include<time.h>
#include<stdlib.h>

typedef struct
{
	char name[20];
	char gender[3]; //用字符串而不用字符可以防止玩家误按回车导致读入个回车就走下一条指令了 
	int age;
	int money;
}character;

int numberguess(void);
int dragonfight(void);
void choose(void);

int main()
{
									//定义变量 
char choice[3];  char status[3];  
int count; // for numberguess
int dragonthing = 3;//0-death ;1-win ; 2 -escape; 3-never met dragon; 
int internalofdragon=0;  int markformath = 0;
int seventeen = 0 ;
								//角色基本信息 
character player1;	
printf("\n创建角色:\n\n"); 
printf("请输入姓名：");
scanf("%s",&player1.name);
fflush(stdin);
printf("请输入性别(M:男 F:女): ");
scanf("%s",&player1.gender[0]);
fflush(stdin);
printf("请输入年龄："); 
scanf("%d",&player1.age);
fflush(stdin);
														//主线选择 
printf("你的身份是？ A普通大学生 B普通公司职员 C法师 \n");
scanf("%s",&status[0]); 
printf("\n");	
fflush(stdin);

													//开始 
printf("请确保键盘大写锁定\n   按回车键开始游戏\n      have fun\n\n");
scanf("start");

									
if (status[0]=='A'){					   				//学生主线 
	start:
	printf("阳光明媚的一天开始了\n你拿着100块钱上学去了(按回车键继续)\n\n");	
	player1.money =100;					
	 	
	fflush(stdin);			//这是为了点回车才继续，防止一直走到下个选项一下出太多字很长 
	scanf("continue");
	fflush(stdin);
	
	printf("你的邻居热情地打招呼：早啊%s!\n",player1.name);		//事件 1 邻居问好 
	printf("你选择： A向他问好 B无视他 C给他唱《两只老虎》\n");
	fflush(stdin);
	scanf("%s",&choice[0]);
	fflush(stdin);
	
	if(choice[0]=='A'){
		printf("你向他摆手道“早上好邻居”。问过好后你很高兴。"); 
	}else if (choice[0]=='B'){
		printf("你没有理会他，自顾自走了过去。"); 
	}else if (choice[0]=='C'){
		printf("你唱起《两只老虎》，邻居哈哈大笑，还觉得你是个傻逼"); 
	}else {
		printf("你愣在原地，邻居喊了你两句你才回过神"); 
	}
	printf("(按回车键继续)");
	fflush(stdin);
	scanf("continue");
	fflush(stdin);
	
	printf("\n\n") ;
																		//事件2 高数课 
	printf("高数课上，老师问：“谁能来证明一下拉格朗日中值定理？”\n此时你\n");
	printf("A胸有成竹地举起了手 B根本不懂老师在说什么 C在玩手机\n");
	scanf("%s",&choice[0]);
	fflush(stdin);
	
	if(choice[0]=='A'){											//2.1老师出错	 
		printf("你是全班唯一一个举手的。老师说：“算了，我自己来吧”\n");
		
			fflush(stdin);
			scanf("continue");
			fflush(stdin);
			
		printf("老师在黑板上奋笔疾书之际，\n你火眼金睛般发现老师竟然有一步把小写x写成大写X了！\n");
		fflush(stdin);
		scanf("continue");
		fflush(stdin);	
		printf("你想：\n");
		printf("A 这么个天大的错误我一定要指出来！\n");
		printf("B 唉，好吧，虽然这个问题很严重我还是假装没发现吧\n");
		scanf("%c",&choice);
		fflush(stdin);
		if (choice[0]=='A'){
			printf("你站了起来，浑身正气缭绕，\n你说：“老师，你把大小写弄错了”，语气淡定而神态庄严\n");
			printf("老师定睛一看，叹了口气说道：“我真是老了，竟然犯这么严重的错误。”\n");
				fflush(stdin);
				scanf("continue");
				fflush(stdin);
			printf("你说：\n");
			printf("A人非圣贤孰能无过，老师我们原谅你\nB就是啊，滚蛋吧你\n");
			scanf("%s",&choice[0]);
			fflush(stdin); 
			printf("老师抹了把眼泪默默走出教室\n全班同学都很崇拜你\nBy the way ,第二天高数老师换人了\n");
			}
		else{
			printf("你默默听课，岁月静好"); 
			}
	}else if (choice[0]=='B'){
		printf("全班没有人举手，老师说：“算了，我自己来吧”\n");
		markformath = 1;
	}else {
		printf("你很专心地没听课，并没听到老师说了什么\n"); 
		markformath = 1;
	}	
	fflush(stdin);
	scanf("continue");
	fflush(stdin);
	printf("\n");
																//2 高数课事件完 ,3 猜数字事件
	printf("课间，一个油腻中年男子走向你请你和他玩猜数字，还说你赢了就给你100块钱。\n");
	printf("你选择： A当然要玩  B扔给他100让他离你远点  C无视掉他  D对他唱唱《小星星》\n");		
	scanf("%s",&choice[0]);
	fflush(stdin);
	if(choice[0]=='A'){
		count = numberguess();
		if(count<=3){
			player1.money += 100;
			printf("\n获得100元，现在你有200元。\n"); 
		} else{
			printf("\n不过你用了%d次，不给你钱了\n",count);
		}
	}else if (choice[0]=='B'){
		printf("男子拿着你的钱悻悻地走了，现在你还剩0元了恭喜啊\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
			printf("\n**************获得成就：身无分文！*********************\n");
		player1.money -= 100;
	}else if (choice[0]=='C'){
		printf("你不理他，自己走了\n");
	}else {
		printf("男子说你唱的很好听给了你一巴掌疼死了\n");
	}
	
	fflush(stdin);
	scanf("continue");
	fflush(stdin);
	printf("\n");
														//3 猜数字事件完  4龙事件 
	printf("中午，你在走路，\n你突然发现面前竟然多了条龙！\n");
	printf("你选择  A揍它  B礼貌地让它别挡道 \n");
	fflush(stdin);
	scanf("%s",&choice[0]);
	if (choice[0]=='B'){
		printf("大龙很听话的让开了路\n"); 
	}else if (choice[0]=='A'){
		dragonthing=dragonfight();
		if(dragonthing==0){
			printf("*******你死掉了，但是是战死的，但是人们不会铭记你的*******\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);
			goto ending;
		}else if (dragonthing==1){
			printf("\n\n获得成就********\"dragon-slayer\"********\n\n");
			printf("龙掉落1000块钱\n");
			player1.money+=1000;
			printf("现在你有%d块钱\n获得材料\"internal of dragon\"\n",player1.money);
			internalofdragon=1;	 
		}
	}
															//4龙事件完 
	fflush(stdin);
	scanf("continue");
	fflush(stdin);
	printf("你往前走了73米后突然意识到---\n")	;
	printf("这他妈的哪来的龙？这不是传说的的生物吗？\n");
	fflush(stdin);
	scanf("continue");
	fflush(stdin);
	if(dragonthing==1){
		printf("可是你身上的战利品提醒你这一切都是真的\n");
	} else if (dragonthing==2){
		printf("可是你刚才与龙打斗留下的伤口还在流血，这不是做梦\n");
	}else if (dragonthing ==3){
		printf("你想，可能是昨天没睡好，出现幻觉了。"); 
	}
	
	printf(" 你晃了晃头，决定不再想龙的事\n ");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);
	if(markformath==1){
		printf("这一晃头，你瞥见高数老师，他竟然拖着个大行李箱\n");
		printf("你决定 A视而不见直接走过去  B上前询问他要去旅游吗\n");
		scanf("%s",&choice[0]);
		fflush(stdin);
		if(choice[0]=='A'){
			printf("你淡定从老师面前走过去。\n其实他根本不认识你\n");
				fflush(stdin);
				scanf("continue");
				fflush(stdin);
		}else {
			printf("你上前询问。\n老师叹了口气说：\n");
			printf("妈蛋, 老子刚刚在另一条故事线里被开除了\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
			printf("****************获得成就：剧情错乱*****************") ;
				fflush(stdin);
			scanf("continue");
			fflush(stdin);
		}
	}
	printf("午饭时间到了\n");
		fflush(stdin);
			scanf("continue");
			fflush(stdin);
	printf("午饭时间结束了\n\n");
		fflush(stdin);
			scanf("continue");
			fflush(stdin);	
															//邂逅事件 for male
	if(player1.gender[0]=='M'){
		printf("你走出餐厅，外面下雨了\n");
		fflush(stdin);
			scanf("continue");
			fflush(stdin);	
		printf("雨不是很大，地还没有湿\n");
		printf("雨点小心翼翼地吻向花坛刚翻新的泥土\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
		printf("花坛边上，一个白衣服的姑娘沿小路走着\n");
		printf("当然路上人不少，穿白衣服的也不止她一个\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
		printf("但是只有她身上像是有淡淡的光环\n她像是把周围都照亮了\n");
		if(dragonthing==1){
			printf("你知道该怎么办\nA上前搭讪  B默默看着她越走越远  C把龙的内脏送给她\n");
		} else{
		printf("你知道该怎么办\tA上前搭讪  B默默看着她越走越远  \n");
		}
			fflush(stdin);
		scanf("%s",&choice[0]);
		fflush(stdin);
		if(choice[0]=='B'){
			printf("她在你视野里渐渐模糊，\n你突然觉得今天可能让你后悔一辈子\n");
			printf("但你仍然没有追上去\n"); 
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
		} else if (choice[0]=='C'){
			printf("你走过去，把依旧炽热的龙之内脏拿出来说要送给她，\n");
			printf("你感觉像是在捧着自己的那份跳动的情意\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
			printf("女孩淡淡张口道：好恶心好吓人还带着血呢\n");
			printf("她跑开了，你手中滚烫的热诚里没有她的温度\n") ;
			printf("再也不会有了\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
		}else if (choice[0]=='A'){
			seventeen = 1;
			printf("你走向女孩：“嘿...呃...虽然我不认识你，但，呃..你想去花坛转转吗？”\n");
			printf("你感觉自己的声音虚得不像自己\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);	
			printf("她被你吓了一跳，愣了两秒后笑了笑说好啊\n");
			printf("多年以后，你告诉她今天的濛濛雨中，你看到了最美的画\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);
			printf("她说她叫seventeen，你记住了\n");
			printf("你明白，在以后无数个日日夜夜里，你总会默念她的名字，seventeen\n");
			fflush(stdin);
			scanf("continue");
			fflush(stdin);
			
		}
		 
	}						
														//邂逅事件 for female
	else if (player1.gender[0]=='F'){
		
	}												 
	// this is the end												
} 							
else if (status[0]=='B'){								//职员主线    不写了 
	printf("作者好累啊，不想写职员的故事线了，你去玩学生线吧。\n");
	printf("A好的     B不行，我今天一定要玩这条线\n")	;
	fflush(stdin);
	scanf("%s",&choice[0]);
	fflush(stdin);
	if(choice[0]=='A'){
		printf("\n\n");
		goto start;
	} else{
		printf("行吧，既然你执意的话,\n你是一名普通公司职员\n有一天你坐时光机回到了学生时代\n") ;
		printf("(按回车键继续)\n\n"); 
		fflush(stdin);
		scanf("continue");
		fflush(stdin);
		goto start;
	}
}												
else if (status[0]=='C'){								//法师主线   也不写了妈蛋 
		printf("作者好累啊，不想写法师的故事线了，你去玩学生线吧。\n");
	printf("A好的     B不行，我今天一定要玩这条线\n")	;
			fflush(stdin);
			scanf("%s",&choice[0]);
			fflush(stdin);
	if(choice[0]=='A'){
		choose(); 
		goto start;
	} else{
		printf("行吧，既然你执意的话,\n你是一个厉害的法师\n有一天你被人剥夺了法力然后扔进时光机回到了学生时代\n");
		printf("(按回车键继续)\n\n"); 
			fflush(stdin);
			scanf("continue");
			fflush(stdin);
		goto start;
	}
}						
else {												//主线没选 
	printf("\n关了吧没意思"); 
}
ending:
printf("\n\n");
printf("(按回车键结束)");
fflush(stdin);
scanf("end");
return 0 ;
}
////////////////////////////////////////////////////////////////main 

///////////////////////////////////////////////////////////////other functions
int numberguess()
{
	srand(time(0));
	int number = rand()%10+1;
	int count = 0 ;
	int a = 0;
	printf("我想好了一个1-10之间的数，三次及以内猜对就算你赢\n");
	
		printf("来猜吧\n");
	do{	scanf("%d",&a);
		count++;
		if(a>number){
			printf("你猜的大了\n"); 
		} else if (a<number){
			printf("你猜的小了\n"); 
		}
	} while(a!=number);
	printf("你猜对了\n");
	return count; 
}

int dragonfight(void){
	int boc = 10;         // blood of character
	int bod = 10;        //blood of dragon
	int turn = 0;
	char moc[3] ; 			//move of character
	int mod =0;       // move of dragon
	int end = 1;   //1-win ; 0-death ; 2-escape
	srand(time(0));
	printf("\n\n---------龙之战-----------\n\n");
	printf("\n你和龙都有10滴血，掉光就死了\n");
	printf("龙会干的事有 打你(让你-1血)、使劲打你(让你-3血)和愤怒咆哮(没什么用)\n\n");
	
	do {												//每回合内容 
	turn++; 
	printf("第%d回合\n",turn);
															//玩家动作 
	printf("你选择： A拿匕首戳龙(使龙-2血)   B防御(本回合不受伤)   C逃跑(离开战场)\n");
	fflush(stdin);
	scanf("%s",&moc[0]);
	if(moc[0]=='C'){						//只要逃跑就不用进行下面的了 
		end = 2;		
		printf("你逃掉了，心有余悸\n"); 
		break;								
	}
																//龙动作 
	mod = rand()%3;
	if (mod ==0 ){								
		printf("龙决定打你一下(-1)\n"); 
	}else if (mod == 1 ){
		printf("龙决定使劲打你一下(-3)\n");
	}else {
		printf("龙愤怒的咆哮了一声\n"); 
	} 
														//结果计算 
	if (moc[0]=='A'){	//玩家选A龙-2，玩家受龙伤害；玩家选B一定什么都没发生；玩家选C上面已经break了； 
		bod-=2;
		if(mod == 0){
			boc-=1;
		}else if (mod==1){
			boc -= 3;
		}
	} 
															//输出本回合结果 
	printf("经过这回合,你还剩%d滴血，龙还剩%d滴血\n\n",boc,bod); 

 }while((boc>0)&&(bod>0)); 
 	if(boc==0){
 		printf("你死了。。\n");
		end = 0; 
	 }else if(bod==0){
	 	printf("你赢了！\n"); 	
	 }
		fflush(stdin);
		scanf("continue");
		fflush(stdin);
	 return end;
}

void choose (void){
	/************ mould of choosing******************
	 
	printf(" A   B  \n");
	fflush(stdin);
	scanf("%s",&choice[0]);
	fflush(stdin);
	if(choice[0]=='A'){
		
	}
	else if (choice[0]=='B'){
		
	}
	
	**************************************************/
	printf("\n");
}


